# Results

## Comparing the Competitiveness of Publishers & Platforms

Here is a plot of Platforms and their global sales amount.
```{r}
library(tidyverse)

ggplot(dataset,aes(x=reorder(Platform,-Global_Sales,FUN = sum),y=Global_Sales)) + 
  geom_col()  +
  labs(title = "Total Sales for Each Platform",x="Platform",y="Sales")

```

We can see that PS3 and X360 are the top 2 platforms that alomost dominated the market. However, is it the case 5 years ago? or even longer before? 

```{r}
nr = nrow(dataset)
y = rep(NA,nr)
for (i in 1:nr){
  if (dataset$Year[i]>= 1996 & dataset$Year[i]<=2003){
    y[i] = "1997-2003"
  } else if (dataset$Year[i] >=2004 & dataset$Year[i] <= 2008){
    y[i] = "2003-2008"
  } else if(dataset$Year[i] >= 2009 & dataset$Year[i] <=2013){
    y[i] = "2009-2013"
  } else{
    y[i] = "2014-2018"
  }
}
dataset = cbind(dataset,y)

ggplot(dataset,aes(x=reorder(Platform,-Global_Sales,FUN = sum),y=Global_Sales)) + 
  geom_col()  + facet_wrap(~y) +
  labs(title = "Total Sales for Each Platform by Year",x="Platform",y="Sales")
```

We can see from this plot that before 2003, the market of video games was not as large as it is right now. PS2 and PS were the only two platforms back then. From 2003 to 2013, PS3 was the most popular platform with X360 following right behind. Games from these two platforms were booming in theose years and they almost took up the entire market at the time. After 2013, platforms like XOne, PS4 and NS began to produce new games and earned fair amount of sales. Their data could potentially go higher as the sales amount was only the number from the release year to 2018. Since there was no record of the sales of PS3 and X360 games after 2013, XOne, PS4, and NS are the emerging platforms that might outperform PS3 and X360 in the future.



Now let us take a look at how many publishers are in our dataset.
```{r}
levels(factor(dataset$Publisher))
```

We are definitely not interested in every one of them, so We picked the top 5 video game publishers by their Global sales amount.

```{r}
g1 <- dataset %>% 
  group_by(Publisher) %>%
  summarize(Global_Sales = sum(Global_Sales)) %>%
  top_n(5) %>%
  ggplot(aes(x=reorder(Publisher,-Global_Sales),y=Global_Sales)) +
  geom_col() +
  labs(title = "Total 5 Video Game Publishers",x="Publisher",y="Sales")
g1
```

Just by looking at the sales amount, the 5 most competitive publishers are Sony Computer Entertainment, Activision, Rockstar Games, Capcom and Ubisoft.







## Top 5 Video Games & Genres


```{r fig.height=10}
library(ggplot2)
library(viridis)

theme_dotplot <- theme_bw(15) +
    theme(axis.text.y = element_text(size = rel(.75)),
        axis.ticks.y = element_blank(),
        axis.title.x = element_text(size = rel(.75)),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(size = 0.6),
        panel.grid.minor.x = element_blank())

names = levels(factor(dataset$Name))
indsales = rep(NA,length(names))
index=1
for (i in names){
  indsales[index] = sum(dataset[dataset$Name==i,]$Global_Sales)
  index=index+1
}
plotdata=data.frame(names=names,indsales=indsales)
ggplot(plotdata,aes(indsales,reorder(names,indsales)))+
  geom_point()+ylab("Game Names")+xlab("Global Sales in Milliom")

```

Graph above shows the total gobal sales for every game. The top five popular games across the world are:\
1.Call of Duty 4: Modern Warfare\
2.Call of Duty: Modern Warfare 2\
3.Grand Theft Auto IV\
4.Assassin's Creed \
5.Grand Theft Auto V \
All of their global sales are over 7.5 millions.

```{r message=FALSE}
library(dplyr)
dataset$Genre=factor(dataset$Genre)
genre = levels(dataset$Genre)
n=length(levels(dataset$Genre))
nasales=rep(NA,n)
eusales=rep(NA,n)
jasales=rep(NA,n)
globalsales = rep(NA,n)
othersales = rep(NA,n)
ind=1

for (i in genre){
  nasales[ind] = sum(dataset[dataset$Genre==i,]$NA_Sales)
  eusales[ind] = sum(dataset[dataset$Genre==i,]$PAL_Sales)
  jasales[ind] = sum(dataset[dataset$Genre==i,]$JP_Sales)
  globalsales[ind] = sum(dataset[dataset$Genre==i,]$Global_Sales)
  othersales[ind] = sum(dataset[dataset$Genre==i,]$Other_Sales)
  ind=ind+1
}

data=data.frame(
  genre = rep(factor(genre),4),
  sales=c(nasales,eusales,jasales,othersales),
  regions=c(rep("NAsales",n),rep("EUsales",n),rep("JapanSales",n),rep("Othersales",n))
)

## sorting by sales
data = data %>% mutate(genre = forcats::fct_reorder(genre, sales, .fun = sum)) 

library(plotly)
## stacked bar chart
p=ggplot(data = data, aes(x = genre, y = sales, fill = regions)) +
  geom_bar(stat='identity') + coord_flip()+ylab("Sales in million")

ggplotly(p)
```

The graph displays the sales for different genres. The colors represent different regions. From the stacked bar chart, we can find out that Action is most popular genre whereas Action-Adventure is the least popular. The top five genres are: Action, Shooter, Role-plying, platform,and Adventure.In addition, we can see that Action and Shooter captures the majority game market. Next, we will look closer to the regional sales by genre.

```{r}
g=ggplot(data = data, aes(x = genre, y = sales)) + 
    geom_bar(stat='identity') +facet_wrap(~regions)+
  ylab("Sales in Million")+ coord_flip()
ggplotly(g)
```

Obviously, North America players contributes most to the game market. The trend of popularity of genres in Europe, North America, and other regions are same as the global trend. Japan is slightly different. 

